# DORM Health Check for Cisco SAN Switch - Deployment Guide

### Purpose

As part of DXC governance and compliance requirements, there’s a need to ensure that ALL DXC and Customer’s Workloads and services are available and functional EVERY DAY.

The Health/Start of the day checks are basically a list of checks that are done to ensure/validate that the identified technologies, systems, and services are available, and functional as expected. These are not monitoring checks and do not replace a monitoring tool/solution. The primary focus is to validate that all systems are available and functional at the start of the day. Should any issue be identified, then relevant actions must be taken to restore the service at the earliest.

All systems and services that affect a Client’s business/productivity are in-scope. For example production workloads, development workloads that are critical for the customer’s business

### Supported OS Versions
* Microsoft Windows Server 2012
* Microsoft Windows server 2008

### Supported Product Versions
* All Cisco Fabric Switchs.

### Supported Powershell Versions
* Powershell Version 3.0 and Above.

_NB: The supported versions often mean/include only the versions against which the automation team were able to test with. It may support other versions too._

### Implementation Overview
![](../images/DORM_HC_Cisco-Switch.PNG)

### Health Checks  
* The script has been developed based on the health checks identified by Global Capability Standards SMEs. Here's the link to the document: _to be added_

Global Health Checks | Low Level Checks | Check Description |
---------------------|------------------|------------------|
Cisco SAN Switch Availability | Availability | This checks for the availability of san Switchs like Environment Fan,temparture,module,error logging,interface brief   |

 
### Deployment Package: 

This deployment package contains the following files.

File | Type | Description
-----|------|-------------
```DORM_HC_Cisco-Switch.ps1``` | Script | The PowerShell script to perform the required checks, and to email the results to OC
```DORM_HC_Cisco-Switch.cfg``` | Configuration file | Configuration file with customizable parameters that are required for Availability check.
```Run.bat``` | script |The batch script to perform the required checks with in the server.


### Deployment Steps

#### 1. CONFIGURATION
*	 The configuration file in the deployment package MUST be customized based on the instructions provided inline.
*	This is an IMPORTANT step as it ensures that the various parameters and thresholds are customized as per the account or environmental requirements. Else, the resulting reports might be erroneous.
*	The output/input directories can be customized as required.

#### 2. DEPLOYMENT
*	The script (```Run.bat```) should be copied to directory on BackupExec windows server in the directory/filesystem such as ```C:/Monitoring/Healthcheck/CiscoSan```.
*	It is recommended to keep the script and config file in the same directory.
*	The script (```DORM_HC_Cisco-Switch.ps1```) and the Configuration file (```DORM_HC_Cisco-Switch.cfg```) should be copied to directory on Jump server in the directory/filesystem such as ```C:/Monitoring/Healthcheck/CiscoSan```.
*	It is recommended to keep the script and config file in the same directory.
*	Note: All log files generated by the script will be stored in the same directory by default.

#### 3. PRE-REQUISITE
*   In order to allow SSH connectivity from Windows to the Cisco SaN Switches, we are using a PowerShell Module. Additional details can be found in this below URL (and the SSH module for PowerShell can be downloaded from the same. It is also supplied along with the deployment package):(```http://www.powershelladmin.com/wiki/SSH_from_PowerShell_using_the_SSH.NET_library#Downloads```)
### Steps to deploy the SSH-Sessions module:
*	Copy the attached SSH-Session zip file, unblock the zip file (in the file properties)
*	Then unzip and place the unzipped folder in one of your PowerShell modules folders which is usually “C:\windows\system32\WindowsPowerShell\<version>\Modules”
*	(```PS C:\<PATH>Import-Module SSH-Sessions```)
### Note: 
*	Modules require PowerShell version 3 or above. The DLL file requires .NET 3.5 or above. 
*	The PowerShell module folders should be listed in the variable (```$env:PSModulePath```). 
*	This is from our test environment (```for eg., PATH: C:\windows\system32\WindowsPowerShell\<version>\Modules```)


#### 3. SCHEDULING

Scheduler | Windows Task Scheduler / Cron
----------|-------------------------------
Schedule | Daily at 6 AM (As per Local timezone)
Script Usage | ```.\Run.bat```
Firewall Ports | SMTP Protocol (Port 25)


#### 4. CONFIRMATION

An output log will be generated in the same folder where the script resides, named ```DORM_HC_Cisco-Switch.log```
This log can be used to analyze output and do error checking, and will be overwritten each time the script is executed. The full report will be saved in the same folder and also sent to the recipients defined in the configuration file.

A successful deployment will lead to a health check result being populated in the Operation Center DORM reports shortly after the scheduled execution time. Note that while ```Test_Mode``` is enabled in the configuration, no results will show up in OC.

For support with this process please raise an [issue in GitHub](https://github.dxc.com/BIONIX-ANZ/dorm-healthchecks/issues/new)
