# DORM Health Check for Backup Exec - Deployment Guide

### Purpose

As part of DXC governance and compliance requirements, there’s a need to ensure that ALL DXC and Customer’s Workloads and services are available and functional EVERY DAY.

The Health/Start of the day checks are basically a list of checks that are done to ensure/validate that the identified technologies, systems, and services are available, and functional as expected. These are not monitoring checks and do not replace a monitoring tool/solution. The primary focus is to validate that all systems are available and functional at the start of the day. Should any issue be identified, then relevant actions must be taken to restore the service at the earliest.

All systems and services that affect a Client’s business/productivity are in-scope. For example production workloads, development workloads that are critical for the customer’s business

### Supported OS Versions
* Microsoft Windows Server 2012
* Microsoft Windows server 2008

### Supported Product Versions
* Backup Exec 13.x,14.x,15.x,16.x.

### Supported Powershell Versions
* Powershell Version 3.0 and Above.

_NB: The supported versions often mean/include only the versions against which the automation team were able to test with. It may support other versions too._

### Implementation Overview
![](../images/DORM_HC_BackupExec.PNG)

### Health Checks  
* The script has been developed based on the health checks identified by Global Capability Standards SMEs. Here's the link to the document: _to be added_

Global Health Checks | Low Level Checks | Check Description |
---------------------|------------------|------------------|
Service Level-Success Rate | SuccessRate | This checks the calculates the BSR ratio of all the servers based on 7 day backup report |
Service Level-Consecutive Failure  |  ConsecutiveFailure  | This verifies the status of the backup server in the last three days |
Service Level-Long Running Backups-12 Hours | LongRunning | This checks for the backups which are running more than 12 hours |
Service Level-Long Running Backups-24 Hours | LongRunning | This checks for the backups which are running more than 24 hours |
Availability-Backup Devices Available | Availability | This checks for the availability of backup tapes |
Availability-Backup Service Available | Availability | This checks for the availability of backup  services |
Availability-Backup Database Backed up | Backup | This verifies whether the backup Master server is properly backed up. |
Capacity-Storage Capacity | Capacity | This check verifies the storage capacity |
Capacity-Tape Capacity | Capacity | This check verifies the Tape capacity |

 
### Deployment Package: 

This deployment package contains the following files.

File | Type | Description
-----|------|-------------
```DORM_HC_BackupExec_Client.ps1``` | Script | The PowerShell script to perform the required checks with in the server.
```DORM_HC_BackupExec_Client.cfg``` | Configuration file | Configuration file with customizable parameters that are required for Availability check.
```DORM_HC_BackupExec_Master.ps1``` | script | The PowerShell script to perform the required checks, and to email the results to OC
```DORM_HC_BackupExec_Master.cfg``` | configuration file | Configuration file with customizable parameters 


### Deployment Steps

#### 1. CONFIGURATION
*	 The configuration file in the deployment package MUST be customized based on the instructions provided inline.
*	This is an IMPORTANT step as it ensures that the various parameters and thresholds are customized as per the account or environmental requirements. Else, the resulting reports might be erroneous.
*	The output/input directories can be customized as required.

#### 2. DEPLOYMENT
*	The script (```DORM_HC_BackupExec_Client.ps1```) and the Configuration file (```DORM_HC_BackupExec_Client.cfg```) should be copied to directory on BackupExec windows server in the directory/filesystem such as ```C:/Monitoring/Healthcheck/BackupExec```.
*	It is recommended to keep the script and config file in the same directory.
*	The script (```DORM_HC_BackupExec_Master.ps1```) and the Configuration file (```DORM_HC_BackupExec_Master.cfg```) should be copied to directory on Jump server in the directory/filesystem such as ```C:/Monitoring/Healthcheck/BackupExec```.
*	It is recommended to keep the script and config file in the same directory.
*	Note: All log files generated by the script will be stored in the same directory by default.

#### 3. SCHEDULING

Scheduler | Windows Task Scheduler / Cron
----------|-------------------------------
Schedule | Daily at 6 AM (As per Local timezone)
Script Usage | ```.\DORM_HC_BackupExec_Master.ps1```
Firewall Ports | SMTP Protocol (Port 25)

#### 4. CONFIRMATION

An output log will be generated in the same folder where the script resides, named ```DORM_HC_BackupExec_Master.log```
This log can be used to analyze output and do error checking, and will be overwritten each time the script is executed. The full report will be saved in the same folder and also sent to the recipients defined in the configuration file.

A successful deployment will lead to a health check result being populated in the Operation Center DORM reports shortly after the scheduled execution time. Note that while ```Test_Mode``` is enabled in the configuration, no results will show up in OC.

For support with this process please raise an [issue in GitHub](https://github.dxc.com/BIONIX-ANZ/dorm-healthchecks/issues/new)
